<style>
    #map-canvas, body, html {
    height: 100%;
    width: 100%;
}
</style>

<script type="text/javascript"
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDtdqGD7EP6P93q36qGHZgjA2N7xJKxQtM">
</script>

<script>
    function initialize() {
        var mapOptions = {
            zoom: 5,
            center: new google.maps.LatLng(40,-117),
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        var map = new google.maps.Map(document.getElementById('map-canvas'),  mapOptions);
        var arr = new Array();
        var polygons = [];
        var bounds = new google.maps.LatLngBounds();

        var Httpreq = new XMLHttpRequest(); // a new request
        Httpreq.open("GET","/geofencing/polygon",false);
        Httpreq.send(null);
        polygons = JSON.parse(Httpreq.responseText);
        

        colors = [
            "#ff0000", 
            "#00ff00", 
            "#0000ff",
            "#001f3f",
            "#0074D9",
            "#7FDBFF",
            "#39CCCC",
            "#3D9970",
            "#2ECC40",
            "#FFDC00",
            "#FF851B",
            "#85144b",
            "#F012BE",
            "#B10DC9",
            "#fd79a8",
            "#ffeaa7",
            "#00cec9",
            "#6c5ce7",
            "#55efc4",
            "#d63031",
            "#3c40c6",
            "#f53b57"
        ];
        for (var i = 0; i < polygons.length; i++) {
            arr = [];
            if (!polygons[i].coordinates) {
                continue;
            }
            var coordinates = polygons[i].coordinates[0];
            for (var j=0; j < coordinates.length; j++) {
                arr.push( new google.maps.LatLng(
                    parseFloat(coordinates[j][1]),
                    parseFloat(coordinates[j][0])
                ));
                bounds.extend(arr[arr.length-1])
            }
            var color = colors[Math.floor(Math.random()*colors.length)];
            polygons.push(new google.maps.Polygon({
                paths: arr,
                strokeColor: color,
                strokeOpacity: 0.8,
                strokeWeight: 2,
                fillColor: color,
                fillOpacity: 0.35
            }));
            polygons[polygons.length-1].setMap(map);
        }
        map.fitBounds(bounds);
    }
    /**
    * Parses the given XML string and returns the parsed document in a
    * DOM data structure. This function will return an empty DOM node if
    * XML parsing is not supported in this browser.
    * @param {string} str XML string.
    * @return {Element|Document} DOM.
    */
    function xmlParse(str) {
    if (typeof ActiveXObject != 'undefined' && typeof GetObject != 'undefined') {
        var doc = new ActiveXObject('Microsoft.XMLDOM');
        doc.loadXML(str);
        return doc;
    }

    if (typeof DOMParser != 'undefined') {
        return (new DOMParser()).parseFromString(str, 'text/xml');
    }

    return createElement('div', null);
    }

    google.maps.event.addDomListener(window, 'load', initialize);
</script>

<div id="map-canvas" ></div>